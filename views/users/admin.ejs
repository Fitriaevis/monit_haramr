<!DOCTYPE html>
<html lang="en">
    <!-- views/partials/head.ejs -->
    <head>
        <%- include('../partials/head') %>
    </head>
    <body class="sb-nav-fixed">
        <!-- views/partials/top_nav.ejs -->
        <%- include('../partials/top_nav') %>
        <div id="layoutSidenav">
            <div id="layoutSidenav_nav">
                <!-- views/partials/side_nav.ejs -->
                <%- include('../partials/side_nav') %>
            </div>
            <div id="layoutSidenav_content">
                <main>
                    <div class="container-fluid px-4">
                        <h1 class="mt-4">Dashboard</h1>
                        <ol class="breadcrumb mb-4">
                            <li class="breadcrumb-item active">Dashboard</li>
                        </ol>
                        <div id="googleMapAll" style="width:100%;height:400px;"></div>
                        <input type="text" name="latitudes" id="latitudes" value="<%= dataSurvei.map(survei => survei.latitude).join(',') %>" hidden>
                        <input type="text" name="longitudes" id="longitudes" value="<%= dataSurvei.map(survei => survei.longitude).join(',') %>" hidden>
                        <input type="text" name="customerNames" id="customerNames" value="<%= dataSurvei.map(survei => survei.nama).join(',') %>" hidden>
                        <!-- <div class="row">
                            <div class="col-xl-3 col-md-6">
                                <div class="card bg-primary text-white mb-4">
                                    <div class="card-body">Primary Card</div>
                                    <div class="card-footer d-flex align-items-center justify-content-between">
                                        <a class="small text-white stretched-link" href="#">View Details</a>
                                        <div class="small text-white"><i class="fas fa-angle-right"></i></div>
                                    </div>
                                </div>
                            </div>
                        </div> -->
                        <!-- views/data_survei/create.ejs -->
                        <!-- view table -->
                        <div class="card mb-4 mt-3">
                            <div class="card-header">
                                <i class="fas fa-table me-1"></i>
                                Data Survei
                            </div>
                            <div class="card-body">
                                <table id="datatablesSimple">
                                    <thead>
                                        <tr>
                                            <th>No.</th>
                                            <th>Foto Phasor</th>
                                            <th>ID PEL</th>
                                            <th>Tanggal Pemeriksaan</th>
                                            <th>Nama</th>
                                            <th>Alamat</th>
                                            <!-- <th>Tarif</th> -->
                                            <!-- <th>Daya</th> -->
                                            <!-- <th>FAKM</th> -->
                                            <!-- <th>No Meter</th> -->
                                            <!-- <th>Maps</th> -->
                                            <!-- <th>LWBP</th> -->
                                            <!-- <th>WBP</th> -->
                                            <!-- <th>BP</th> -->
                                            <!-- <th>Total</th> -->
                                            <!-- <th>KVARH</th> -->
                                            <!-- <th>Merk CB/MCCB</th> -->
                                            <!-- <th>Type CB/MCCB</th> -->
                                            <!-- <th>Merk CT</th> -->
                                            <!-- <th>Ganti Modem</th> -->
                                            <!-- <th>No Meter Update</th> -->
                                            <!-- <th>Merk Modem</th> -->
                                            <!-- <th>Type Modem</th> -->
                                            <!-- <th>Simcard</th> -->
                                            <!-- <th>IP Access</th> -->
                                            <!-- <th>Foto APP</th> -->
                                            <!-- <th>Foto Meter</th> -->
                                            <!-- <th>Foto CT</th> -->
                                            <!-- <th>Foto CB/MCCB</th> -->
                                            <!-- <th>Foto BA</th> -->
                                            <!-- <th>Shuntrip</th> -->
                                            <!-- <th>Foto Segel</th> -->
                                            <!-- <th>Error KWN %</th> -->
                                            <th>Permasalahan</th>
                                            <th>Petugas</th>
                                            <th>Action</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <% for(var i = 0; i < dataSurvei.length; i++){ %>
                                        <tr data-latitude="<%= dataSurvei[i].latitude %>" data-longitude="<%= dataSurvei[i].longitude %>">
                                            <th scope="row"><%= (i+1) %></th>
                                            <td>
                                                <% if(dataSurvei[i].foto_phasor) { %>
                                                    <a href="/images/upload/<%= dataSurvei[i].file_report %>" target="_blank">Lihat</a>
                                                <% } else { %>
                                                    Tidak ada file
                                                <% } %>
                                            </td>
                                            <td><%= dataSurvei[i].id_pel %></td>
                                            <td><%= new Date(dataSurvei[i].tanggal_pemeriksaan).toLocaleString('id-ID', { timeZone: 'Asia/Jakarta' }) %></td>
                                            <td><%= dataSurvei[i].nama %></td>
                                            <td><%= dataSurvei[i].alamat %></td>
                                            <td><%= dataSurvei[i].jenis_permasalahan %></td>
                                            <td><%= dataSurvei[i].petugas %></td>
                                            <td>
                                                <a href="/data_survei/detail/<%= dataSurvei[i].id_data_survei %>" class="btn btn-info btn-action">
                                                    <i class="bi bi-view-list icon-small"></i>
                                                </a>
                                            </td>
                                        </tr>
                                        <% } %>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </main>
                <footer class="py-4 bg-light mt-auto">
                    <%- include('../partials/footer') %>
                </footer>
            </div>
        </div>
        <%- include('../partials/script') %>
    </body>
</html>
